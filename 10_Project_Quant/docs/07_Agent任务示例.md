# Agent 任务执行示例（给 TREA / 其他 AI Agent）

## 任务执行流程（强制）
1. **理解**：先阅读并遵循：
   - `docs/01_项目架构与愿景.md`
   - `docs/02_技术栈与规范.md`
   - `docs/03_API设计规范.md`
2. **分析**：定位现有代码位置、复用已有模式（不要凭空引入新框架/新库）。
3. **执行**：按现有目录结构实现，并补齐必要测试。
4. **验证**：后端跑 `pytest`，前端跑 `npm run check`，关键页面可本地预览。

## 经典任务模板

### 模板 1：新增一个 API 端点
“我需要一个用于【业务描述】的 API 端点。”
- 你的操作：
  1. 在 `api/schemas.py` 添加请求/响应模型（或拆分到新模块并在该文件引用）。
  2. 在 `api/crud.py` 或 `api/services/` 实现业务逻辑。
  3. 在 `api/routers/xxx.py` 增加端点，并按 `docs/03_API设计规范.md` 返回。
  4. 在 `api/tests/` 增加测试。

### 模板 2：实现一个数据源适配器
“接入【新数据源】提供基金净值数据。”
- 你的操作：
  1. 在 `api/services/` 新增数据源文件（只负责：请求/解析/结构化）。
  2. 在 `api/crud.py` 增加 upsert 方法，控制落库。
  3. 在 `api/routers/funds.py` 的 `/sync` 接口中增加切换逻辑（通过参数或配置）。
  4. 增加解析单测（避免外部格式变化导致崩溃）。

### 模板 3：新增一个前端页面/功能块
“基金页面新增【功能】。”
- 你的操作：
  1. 在 `src/services/api.ts` 增加对应 API 封装函数。
  2. 在 `src/pages/` 对应页面实现 UI 与交互（Ant Design）。
  3. 在 `src/utils/` 复用或新增工具（如缓存/格式化）。
  4. 运行 `npm run check` 确保类型正确。

### 模板 4：修复 Bug
“请分析错误日志并修复。”
- 你的操作：
  1. 用最小复现定位文件与原因。
  2. 提交修复代码。
  3. 补测试覆盖（能复现并防回归）。

